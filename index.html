<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Interactive Restaurant Floorplan - Responsive</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f7f7f7;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  .hidden {
    display: none !important;
  }
  .login-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex: 1;
  }
  .login-box {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 300px;
  }
  .tables-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 8px;
    padding: 10px;
    flex: 1;
  }
  .table {
    background: #e6f0ff;
    border-radius: 6px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 5px;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    min-height: 80px;
  }
  .table.billed {
    background: #90ee90;
  }
  .capacity {
    font-size: 12px;
    color: #555;
  }
  .number {
    font-size: 18px;
    font-weight: bold;
  }
  .timer {
    font-size: 10px;
    color: #333;
  }
  .floating-status {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    padding: 16px;
    margin: 10px;
  }
  #clearedList div { cursor: pointer; }

  /* Mobile adjustments */
  @media (max-width: 768px) {
    .tables-container {
      grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    }
    .table { min-height: 70px; }
    .capacity { font-size: 11px; }
    .number { font-size: 16px; }
    .timer { font-size: 9px; }
    .floating-status {
      width: 100%;
      border-radius: 0;
      margin: 0;
    }
  }
  @media (max-width: 480px) {
    .tables-container {
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    }
    .table { min-height: 60px; }
    .capacity { font-size: 10px; }
    .number { font-size: 14px; }
    .timer { font-size: 8px; }
  }
</style>
</head>
<body>

<div class="login-container" id="loginScreen">
  <div class="login-box">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username"/><br/><br/>
    <input type="password" id="password" placeholder="Password"/><br/><br/>
    <button id="loginBtn">Sign In</button>
    <div id="loginError" style="color:red;margin-top:8px;"></div>
  </div>
</div>

<div id="mainContent" class="hidden">
  <div class="tables-container" id="tablesContainer"></div>
  <div class="floating-status">
    <h3>Booked Tables</h3>
    <div id="statusList"></div>
    <h4>Billed Table</h4>
    <div id="clearedList"></div>
    <button id="resetBtn">Reset</button>
  </div>
</div>

<script>
  const loginScreen = document.getElementById('loginScreen');
  const mainContent = document.getElementById('mainContent');
  const loginBtn = document.getElementById('loginBtn');
  const loginError = document.getElementById('loginError');

  // Keep login state on refresh
  if (localStorage.getItem('loggedIn') === 'true') {
    loginScreen.classList.add('hidden');
    mainContent.classList.remove('hidden');
  }

  loginBtn.addEventListener('click', () => {
    const user = document.getElementById('username').value.trim();
    const pass = document.getElementById('password').value.trim();
    if (user === 'admin' && pass === '1234') {
      localStorage.setItem('loggedIn', 'true');
      loginScreen.classList.add('hidden');
      mainContent.classList.remove('hidden');
    } else {
      loginError.textContent = 'Invalid username or password';
    }
  });

  const tablesContainer = document.getElementById('tablesContainer');
  const resetBtn = document.getElementById('resetBtn');
  const statusList = document.getElementById('statusList');
  const clearedList = document.getElementById('clearedList');
  let timers = {};
  let recentCleared = [];

  // Table definitions
  const rows = [[1,8],[9,14],[15,22]];
  let tableData = [];
  rows.forEach(range => {
    let [start, end] = range;
    for (let id = start; id <= end; id++) {
      if (id === 13 || id === 17) continue;
      let cap = 2;
      if (id >= 9 && id <= 14) cap = 4;
      else if (id >= 15 && id <= 19) cap = 8;
      else if (id % 2 === 0) cap = 3;
      tableData.push({id, cap});
    }
  });

  // Generate grid tables
  tableData.forEach(t => {
    const tableEl = document.createElement('div');
    tableEl.className = 'table';
    tableEl.dataset.id = t.id;
    tableEl.dataset.capacity = t.cap;

    tableEl.innerHTML = `
      <div class="capacity">${t.cap} pac</div>
      <div class="number">${t.id}</div>
      <div class="timer"></div>
    `;

    tableEl.addEventListener('click', () => {
      if (!tableEl.classList.contains('billed')) {
        tableEl.classList.add('billed');
        startTimer(tableEl);
      } else {
        clearTable(tableEl);
      }
    });

    tablesContainer.appendChild(tableEl);
  });

  function startTimer(table){
    const id = table.dataset.id;
    const timerEl = table.querySelector('.timer');
    timers[id] = {start: Date.now(), elapsed: '00:00'};
    timers[id].interval = setInterval(()=>{
      let diff = Date.now() - timers[id].start;
      let mins = Math.floor(diff/60000);
      let secs = Math.floor((diff%60000)/1000);
      timers[id].elapsed = `${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
      timerEl.textContent = timers[id].elapsed;
      renderStatus();
    },1000);
  }

  function clearTable(table){
    table.classList.remove('billed');
    const id = table.dataset.id;
    clearInterval(timers[id]?.interval);
    delete timers[id];
    table.querySelector('.timer').textContent = '';
    recentCleared.unshift(`Table ${id} (${table.dataset.capacity} pac)`);
    renderStatus();
  }

  function renderStatus(){
    statusList.innerHTML = '';
    document.querySelectorAll('.table.billed').forEach(t=>{
      statusList.innerHTML += `<div>Table ${t.dataset.id} (${t.dataset.capacity} pac) - billed</div>`;
    });
    clearedList.innerHTML = recentCleared.map(t=>`<div>${t}</div>`).join('');
  }

  resetBtn.addEventListener('click',()=>{
    document.querySelectorAll('.table').forEach(t=>clearTable(t));
    recentCleared = [];
    renderStatus();
  });
</script>

</body>
</html>
